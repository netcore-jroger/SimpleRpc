version: '0.1.{build}'
image:
  - Visual Studio 2017
  - Ubuntu
configuration: Release
branches:
  only:
  - master
init:
  - cmd: git config --global core.autocrlf true
install:

before_build:
  - cmd: dotnet --version
  - cmd: dotnet restore ./SimpleRpc.sln --verbosity m

build_script:
  - cmd: dotnet publish ./SimpleRpc.sln -c Release

after_build:

on_finish:

nuget:
  disable_publish_on_pr: true
  on:
    APPVEYOR_REPO_TAG: true

for:
-
  matrix:
    only:
      - image: Ubuntu

  deploy:
  - provider: NuGet
    name: production
    api_key:
      secure: ceJi177DdM8KLdPZg4UjO4X6sigL2blN3O2gaRbJpD7XiJGuhMIjEjLIf6C2mB0E
    skip_symbols: true
    artifact: /.*\.nupkg/
    on:
      branch: master
      APPVEYOR_REPO_TAG: true
    
  - provider: Environment
    name: production
    on:
      APPVEYOR_REPO_TAG: true